// classifier.js

// üö´ –ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–ª–æ–≤–∞
const bannedWords = ["—Å–æ—Å–∞—Ç—å", "—Å–µ–∫—Å", "–ø–æ—Ä–Ω–æ", "—ç—Ä–æ—Ç–∏–∫–∞", "–º–∞—Ç", "—Ö—É", "–µ–±"];

// üÜò –°–ª–æ–≤–∞ –¥–ª—è –≤—ã–∑–æ–≤–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
const operatorWords = [
  "–æ–ø–µ—Ä–∞—Ç–æ—Ä",
  "–∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫",
  "—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç",
  "–ø–æ–∑–æ–≤–∏",
  "–ø–æ–∑–≤–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É",
  "–ø–µ—Ä–µ–¥–∞–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É"
];

// üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
const categories = {
  "–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è": ["–≤—Ö–æ–¥", "–ª–æ–≥–∏–Ω", "–ø–∞—Ä–æ–ª—å", "–∞–∫–∫–∞—É–Ω—Ç"],
  "–û–ø–ª–∞—Ç–∞": ["–æ–ø–ª–∞—Ç–∞", "—Å—á–µ—Ç", "–∫–∞—Ä—Ç–∞", "–ø–æ–¥–ø–∏—Å–∫–∞", "—á–µ–∫"],
  "–û—à–∏–±–∫–∏": ["–æ—à–∏–±–∫–∞", "500", "–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç", "–≤—ã–ª–µ—Ç–∞–µ—Ç", "–∑–∞–≤–∏—Å–∞–µ—Ç", "–±–∞–≥"],
  "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å": ["–Ω–∞—Å—Ç—Ä–æ–π–∫–∞", "—É—Å—Ç–∞–Ω–æ–≤–∫–∞", "–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"]
};

/**
 * –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–∞
 */
export function isAllowedQuestion(question) {
  return !bannedWords.some(word => question.toLowerCase().includes(word));
}

/**
 * –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–Ω–æ –ø—Ä–æ—Å–∏—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
 */
export function isOperatorRequest(question) {
  return operatorWords.some(word => question.toLowerCase().includes(word));
}

/**
 * –ü—Ä–æ—Å—Ç–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
 */
export function classifySimple(question) {
  const q = question.toLowerCase();

  // –û—à–∏–±–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—ã–º–∏, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞–ª–æ—Å—å —Å –¥—Ä—É–≥–∏–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
  if (/(–æ—à–∏–±–∫–∞|500|–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç|–≤—ã–ª–µ—Ç–∞–µ—Ç|–∑–∞–≤–∏—Å–∞–µ—Ç|–±–∞–≥)/.test(q)) {
    return "–û—à–∏–±–∫–∏";
  }

  for (const [category, keywords] of Object.entries(categories)) {
    if (keywords.some(word => q.includes(word))) {
      return category;
    }
  }

  return "–î—Ä—É–≥–æ–µ";
}
